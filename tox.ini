# Generated by nens-meta.
# See https://nens-meta.readthedocs.io/en/latest/config-files.html for info.
# If you want this file to be left alone, add "nens_meta_leave_alone" in
# all caps somewhere in this file in a comment.
#

[tox]
# If locally you don't have all the various python versions: that's OK, we'll skip them.
skip_missing_interpreters = true
# We need 4.4.0 for constrain_package_deps.
min_version = 4.4.0
# envlist is what gets run by default if you just type "tox".
# The idea is that just running "tox" is equivalent to the checks that happen on github.
envlist =
    lint
    py310
    py311
    py312
    coverage

[testenv]
description = Run the tests
use_develop = true
skip_install = false
constrain_package_deps = true
extras = test
commands = pytest --no-header --tb line

[testenv:lint]
description = Run formatters/linters for basic code sanity and neatness
skip_install = true
deps = pre-commit
commands = pre-commit run --all

[testenv:format]
description = Automatically reformat code
skip_install = true
deps = ruff
commands = ruff format

[testenv:test]
description = Run the tests with the default python

[testenv:coverage]
description = Get a test coverage report
use_develop = true
skip_install = false
constrain_package_deps = true
allowlist_externals = sh
deps = coverage
extras = test
commands =
    coverage run -m pytest --no-header --tb line
    coverage xml
    coverage html
    - sh -c 'coverage report --format markdown > for_step_summary.md'
    coverage report --fail-under 1 --format text

### Extra lines below are preserved ###
